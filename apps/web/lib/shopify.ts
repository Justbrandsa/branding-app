import { shopifyApi, ApiVersion } from "@shopify/shopify-api"; const shop=process.env.SHOPIFY_SHOP!; const token=process.env.SHOPIFY_ADMIN_TOKEN!; const apiVersion=(process.env.SHOPIFY_ADMIN_API_VERSION||"2024-07") as ApiVersion; export function getAdminClient(){ if(!shop||!token) throw new Error("Missing SHOPIFY_SHOP or SHOPIFY_ADMIN_TOKEN"); return { async gql(q:string,v?:Record<string,any>){ const res=await fetch(`https://${shop}/admin/api/${apiVersion}/graphql.json`,{method:"POST",headers:{"X-Shopify-Access-Token":token,"Content-Type":"application/json"},body:JSON.stringify({query:q,variables:v})}); const json=await res.json(); if(json.errors) throw new Error(JSON.stringify(json.errors)); return json.data; }, shop, apiVersion } as const; }
